[192.168.1.12:18217] SET PYTHONUNBUFFERED=1
[192.168.1.12:18217] SET MPLBACKEND=Agg
[INFO] world=4 act=sigmoid hidden=129 lr=0.0003 batch=64 epochs=5
[Loader] feat_dim=10  train_local_rows=6498899  test_rows=11136503
[DATA] features=10; local train rows=6498899 | test rows (global)=11136503
[Epoch    1] starting…
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: divide by zero encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: overflow encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: invalid value encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: divide by zero encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: overflow encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: invalid value encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: divide by zero encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: overflow encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: invalid value encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: divide by zero encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: overflow encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: invalid value encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
[Rank 2] gW1(10, 129) float32 | gb1(129,) float32 | gW2(129, 1) float32 | gb2(1,) float32
[Rank 2] Starting gradient sync
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: divide by zero encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: overflow encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: invalid value encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: divide by zero encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: overflow encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: invalid value encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: divide by zero encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: overflow encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: invalid value encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: divide by zero encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: overflow encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: invalid value encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
[Rank 3] gW1(10, 129) float32 | gb1(129,) float32 | gW2(129, 1) float32 | gb2(1,) float32
[Rank 3] Starting gradient sync
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: divide by zero encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: overflow encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: invalid value encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: divide by zero encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: overflow encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: invalid value encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: divide by zero encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: overflow encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: invalid value encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: divide by zero encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: overflow encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: invalid value encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
[Rank 1] gW1(10, 129) float32 | gb1(129,) float32 | gW2(129, 1) float32 | gb2(1,) float32
[Rank 1] Starting gradient sync
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: divide by zero encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: overflow encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:187: RuntimeWarning: invalid value encountered in matmul
  Z1 = X @ self.W1 + self.b1[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: divide by zero encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: overflow encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:189: RuntimeWarning: invalid value encountered in matmul
  Yhat = A1 @ self.W2 + self.b2[None, :]
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: divide by zero encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: overflow encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:201: RuntimeWarning: invalid value encountered in matmul
  self.gW2[:] = (A1.T @ diff) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: divide by zero encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: overflow encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:205: RuntimeWarning: invalid value encountered in matmul
  self.gW1[:] = (X.T @ dZ1) / B
[Rank 0] gW1(10, 129) float32 | gb1(129,) float32 | gW2(129, 1) float32 | gb2(1,) float32
[Rank 0] Starting gradient sync
[Rank 0] Finished gradient sync
[Rank 2] Finished gradient sync
[Rank 1] Finished gradient sync
[Rank 3] Finished gradient sync
[Epoch    1] loss=16.523106 (best 16.523106) steps=101546 time=15.88s
[Epoch    2] starting…
[Epoch    3] starting…
[Epoch    4] starting…
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:162: RuntimeWarning: overflow encountered in exp
  if kind == "sigmoid": return 1.0 / (1.0 + np.exp(-z))
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:162: RuntimeWarning: overflow encountered in exp
  if kind == "sigmoid": return 1.0 / (1.0 + np.exp(-z))
[Epoch    5] starting…
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:162: RuntimeWarning: overflow encountered in exp
  if kind == "sigmoid": return 1.0 / (1.0 + np.exp(-z))
/Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/src/train_mpi_sgd.py:162: RuntimeWarning: overflow encountered in exp
  if kind == "sigmoid": return 1.0 / (1.0 + np.exp(-z))
[Epoch    5] loss=8.764593 (best 8.764593) steps=101546 time=16.96s
[Rank 0] Eval progress: 9994240/11136503 rows processed
[Rank 3] Eval progress: 9994240/11136503 rows processed
[Rank 1] Eval progress: 9994240/11136503 rows processed
[Rank 2] Eval progress: 9994240/11136503 rows processed
[Rank 0] POST: global RMSE=4.224048 (sse=794815694.12, n=44546012)
\n=== Results ===
Activation     : sigmoid
Hidden units   : 129
Batch size     : 64
Learning rate  : 0.0003
Epochs run     : 5
Train RMSE     : 4.134329
Test  RMSE     : 4.224048
Train time (s) : 87.25
✓ Results saved in /Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/results/scaling

✓ Finished single run in 107.23s. Artifacts: /Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/results/scaling

✓ Finished single run in 107.24s. Artifacts: /Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/results/scaling

✓ Finished single run in 107.24s. Artifacts: /Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/results/scaling

✓ Finished single run in 107.24s. Artifacts: /Users/koushik/Desktop/MS/DSA5208/Project/DSA5208_Stochastic_Gradient_Descent_MPI/results/scaling
